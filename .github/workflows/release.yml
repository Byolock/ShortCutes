name: |
  Title: Update | Asset: Build & Upload
on:  
  release:
    types: [published]
    branches: [ main ]

jobs:  
  build:    
    runs-on: windows-latest
    
    steps:      
        - uses: actions/checkout@v2
        
        - name: Navigate to Workspace
          run: cd ${{ github.workspace }}
          
        - name: Setup MSBuild
          uses: microsoft/setup-msbuild@v1.1
        
        - name: Build Solution
          run: |
            msbuild ShortCutes.sln -restore -p:RestorePackagesConfig=true -p:platform="Any CPU" -p:Configuration=Release
            
        - name: Upload Release Asset
          id: upload-release-asset 
          uses: actions/upload-release-asset@v1
          env:
            GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          with:
            upload_url: ${{ github.event.release.upload_url }}
            asset_path: ShortCutes\bin\Release\ShortCutes.exe
            asset_name: ShortCutes.exe
            asset_content_type: application/x-msdownload

        - name: Update Release Title & Status
          id: update_release
          uses: tubone24/update_release@v1.0
          env:
            GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
            TAG_NAME: ${{ github.event.release.tag_name }}
          with:
            prerelease: false
            release_name: ShortCutes ${{ github.event.release.tag_name }}
